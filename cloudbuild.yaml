steps:
- name: 'gcr.io/cloud-builders/docker'
  entrypoint: 'bash'
  args:
  - '-c'
  - |
   docker pull gcr.io/$PROJECT_ID/github.com/umpyre-code/rolodex:latest || true
- name: 'gcr.io/cloud-builders/docker'
  entrypoint: 'bash'
  args:
  - '-c'
  - |
   docker pull rustlang/rust:nightly || true
- name: 'gcr.io/cloud-builders/docker'
  entrypoint: 'bash'
  args: ['-c', 'docker build --build-arg SSH_KEY="$$SSH_KEY" --build-arg SCCACHE_KEY="$$SCCACHE_KEY"  -t gcr.io/$PROJECT_ID/github.com/umpyre-code/rolodex:latest -t gcr.io/$PROJECT_ID/github.com/umpyre-code/rolodex:$REVISION_ID --cache-from gcr.io/$PROJECT_ID/github.com/umpyre-code/rolodex:latest --cache-from rustlang/rust:nightly .']
  secretEnv: ['SSH_KEY', 'SCCACHE_KEY']
images: [
   'gcr.io/$PROJECT_ID/github.com/umpyre-code/rolodex:latest','gcr.io/$PROJECT_ID/github.com/umpyre-code/rolodex:$REVISION_ID',
]
timeout: 1h
secrets:
- kmsKeyName: projects/umpyre/locations/global/keyRings/deploy/cryptoKeys/deploy-key
  secretEnv:
    SSH_KEY: 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
    SCCACHE_KEY: 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
