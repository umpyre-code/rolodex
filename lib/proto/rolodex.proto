syntax = "proto3";

option java_multiple_files = true;
option java_package = "io.grpc.rolodex";
option java_outer_classname = "RolodexProto";

package rolodex;

service Rolodex {
  rpc AddUser(NewUserRequest) returns (NewUserResponse) {}
  rpc Authenticate(AuthRequest) returns (AuthResponse) {}
}

message NewUserRequest {
  string full_name = 1;
  string phone_number = 2;
  string email = 3;
  string password_hash = 4;
}

message NewUserResponse {
  enum Error {
    InvalidPhoneNumber = 0;
    InvalidEmail = 1;
    LowQualityPassword = 2;
  }
  oneof result {
    string user_id = 1;
    Error error = 2;
  }
}

message AuthRequest {
  string user_id = 1;
  string password_hash = 2;
}

message AuthResponse {
  enum Result {
    SUCCESS = 0;
    FAILURE = 1;
  }
  Result result = 1;
  string auth_token = 2;
}
