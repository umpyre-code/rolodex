syntax = "proto3";

package rolodex;

service Rolodex {
  rpc AddUser(NewUserRequest) returns (NewUserResponse) {}
  rpc Authenticate(AuthRequest) returns (AuthResponse) {}
}

message PhoneNumber {
  string country = 1; // Two-letter country (CA, US, UK, ...)
  string number = 2;  // National number
}

message NewUserRequest {
  string full_name = 1;
  string password_hash = 2;
  string email = 3;
  PhoneNumber phone_number = 4;
}

enum Error {
  InvalidPhoneNumber = 0;
  InvalidEmail = 1;
  LowQualityPassword = 2;
  BadCredentials = 3;
  DatabaseError = 4;
  EmailDNSFailure = 5;
  InvalidUserId = 6;
}

message NewUserResponse {
  oneof result {
    string user_id = 1;
    Error error = 2;
  }
}

message AuthRequest {
  string user_id = 1;
  string password_hash = 2;
}

message AuthResponse {
  oneof result {
    string user_id = 1;
    Error error = 2;
  }
}
