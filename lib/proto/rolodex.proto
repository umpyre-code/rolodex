syntax = "proto3";

package rolodex;
option java_package = "rolodex";

service Rolodex {
  rpc AddUser(NewUserRequest) returns (NewUserResponse);
  rpc Authenticate(AuthRequest) returns (AuthResponse);
  rpc GetUser(GetUserRequest) returns (GetUserResponse);
  rpc Check(HealthCheckRequest) returns (HealthCheckResponse);
}

message PhoneNumber {
  string country_code = 1; // Two-letter country (CA, US, UK, ...)
  string national_number = 2;
}

message NewUserRequest {
  string full_name = 1;
  string password_hash = 2;
  string email = 3;
  PhoneNumber phone_number = 4;
  string public_key = 5;
}

message NewUserResponse { string user_id = 1; }

message AuthRequest {
  string user_id = 1;
  string password_hash = 2;
}

message AuthResponse { string user_id = 1; }

message GetUserRequest {
  string calling_user_id = 1;
  string user_id = 2;
}

message GetUserResponse {
  string user_id = 1;
  string full_name = 2;
  string public_key = 3;
}

message HealthCheckRequest { string service = 1; }

message HealthCheckResponse {
  enum ServingStatus {
    UNKNOWN = 0;
    SERVING = 1;
    NOT_SERVING = 2;
  }
  ServingStatus status = 1;
}
